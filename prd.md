# 블로그 라이터 PRD (Product Requirements Document)

## 제품 개요
뷰티샵 원장님들을 위한 AI 블로그 글 자동 생성 SaaS 서비스

### 핵심 가치
- "규칙은 시스템이 책임집니다" - 사용자는 키워드만 입력하면 SEO 최적화된 블로그 글 자동 생성
- 실력을 직접 말하지 않고, 판단 기준을 제시하여 실력이 드러나는 글 작성

### 타겟 사용자
- 뷰티샵 (피부관리실, 네일샵, 헤어샵 등) 원장님
- 블로그 마케팅이 필요하지만 글쓰기에 시간을 쓰기 어려운 분들

---

## 기술 스택

| 구분 | 기술 |
|------|------|
| 프레임워크 | Next.js 16.1.4 (App Router) |
| 스타일링 | Tailwind CSS v4 |
| AI | Google Gemini 2.0 Flash API |
| 인증/DB | Supabase (Auth + PostgreSQL) |
| 배포 | Vercel |
| 결제 | (예정) 토스페이먼츠 or Stripe |

---

## 완료된 기능 (Stage 1)

### 1. 글 생성 기능 ✅
- **SEO 글**: 9단계 마법사 (글유형 → 업종 → 키워드 → 주제 → 목적 → 독자상태 → 규칙확인 → 제목선택 → 생성)
- **브랜딩 글**: 7단계 마법사 (글유형 → 업종 → 브랜딩종류 → 키워드 → 추가정보 → 제목선택 → 생성)
- Gemini 2.0 Flash API 연동
- 1,500자 이상 SEO 최적화 글 생성
- 마크다운 없는 순수 텍스트 출력
- 복사하기 기능

### 2. Supabase 인증 시스템 ✅
- 이메일/비밀번호 회원가입 및 로그인
- 미들웨어 기반 인증 보호
- 로그아웃 기능
- 세션 관리

### 3. 데이터베이스 ✅
- **profiles**: 사용자 정보 + 플랜 + 사용량 + 지역 + 블로그 지수
- **histories**: 생성된 글 히스토리
- **settings**: 사용자 설정 (기본 업종)
- RLS (Row Level Security) 적용 - 본인 데이터만 접근

### 4. 사용량 제한 ✅
- 무료 플랜: 하루 3회 생성
- 유료 플랜: 무제한 (결제 시스템 구현 후 활성화)
- 날짜 변경 시 자동 리셋

### 5. UI/UX ✅
- 반응형 레이아웃 (모바일/데스크톱)
- 사이드바 + 탑바 구조
- 로딩 애니메이션 + UX 메시지
- 에러 핸들링 (재시도 UI)

### 6. 스마트 키워드 추천 시스템 ✅ (NEW)

#### 6-1. 지역 설정 ✅
- 설정 페이지에서 샵 위치 입력 (시/구/동)
- 예: 서울시 강남구 신사동
- DB 저장: profiles 테이블의 location 필드

#### 6-2. 블로그 지수 시스템 (블덱스 기준) ✅
- 블덱스(blogdex.space) 기반 지수 체계
- **최적화 (1~3)**: 구/시 단위 경쟁 키워드 가능
- **준최적화 5~7**: 동 단위 키워드 추천
- **준최적화 1~4**: 동 + 세부 키워드 조합 (예: 역삼동여자눈썹문신)
- **일반 (구 준최0)**: 초세부 틈새 키워드 (예: 신사동망한눈썹문신)

#### 6-3. AI 키워드 추천 ✅
- 지역 + 업종 + 블로그 지수 기반 맞춤 키워드 5개 추천
- Gemini AI를 통한 실시간 키워드 분석
- 추천 이유 설명 포함
- 직접 입력 옵션 제공

### 7. AI 제목 추천 시스템 ✅ (NEW)

#### 7-1. 제목 생성 ✅
- 글 생성 전 AI가 제목 후보 3개 추천
- 클릭률 높이는 제목 스타일:
  - 궁금증 유발 ("~하면 후회하는 3가지")
  - 수치화 ("90%가 모르는", "5분만에")
  - 자극적 단어 ("충격", "실수", "비밀", "진짜")
- 직접 입력 옵션 제공

#### 7-2. 제목 적용 ✅
- 선택된 제목이 본문 생성 시 자동 적용
- 제목과 본문의 일관성 유지

### 8. 규제 업종 보호 규칙 ✅ (NEW)

#### 1인칭 표현 금지 (반영구 업종) ✅
- "저는", "제가", "저희" 등 1인칭 표현 절대 금지
- "저희 샵", "저희 매장", "우리 샵" 금지
- "제가 시술한", "저는 이런 원장입니다" 등 시술자 관점 금지
- 시스템 프롬프트에서 강력하게 제어
- 정보 전달자/안내자 관점으로만 작성

### 9. 키워드 하이라이트 시스템 ✅ (NEW)

#### 형광펜 표시 ✅
- 생성된 글에서 핵심 키워드를 노란색 형광펜으로 자동 표시
- 키워드 위치를 한눈에 파악 가능
- 복사 시 원본 텍스트만 복사 (형광펜 없이)

#### 키워드 배치 규칙 ✅
- 키워드는 본문에 반드시 3회 이상 자연스럽게 포함
- **처음**: 본문 시작 후 첫 2~3문장 이내에 1회 언급
- **중간**: 본문 중간 부분에서 1회 언급
- **마지막**: 본문 끝나기 전 2~3문장 이내에 1회 언급
- 시스템 프롬프트와 유저 프롬프트에서 강력하게 지시

### 10. 브랜딩 글 작성 기능 ✅ (NEW)

#### 10-1. 글 유형 선택 ✅
- 첫 단계에서 SEO 글 / 브랜딩 글 선택
- 선택에 따라 이후 단계가 동적으로 변경

#### 10-2. 브랜딩 종류 ✅
| 종류 | 설명 |
|------|------|
| 자기소개 | 원장님 소개, 경력, 가치관 |
| 철학/신념 | 샵이 추구하는 가치와 철학 |
| 샵 스토리 | 공간, 분위기, 시작 이야기 |

#### 10-3. 구체적 질문 UI ✅
| 자기소개 | 철학/신념 | 샵 스토리 |
|---------|----------|----------|
| 경력이 어떻게 되시나요? | 가장 중요한 가치는? | 샵이 어디에 있나요? |
| 전문 분야는? | 다른 샵과 다른 점? | 언제 시작하셨나요? |
| 시작한 계기? | 왜 그런 철학을? | 공간의 특징? |
| 고객 대하는 마음? | 전하고 싶은 메시지? | 어떤 분위기? |

#### 10-4. 브랜딩 글 규칙 ✅
- 1인칭 표현 금지 유지 (3인칭 시점)
- 1,500자 이상 작성
- 키워드 3회 배치 유지
- 마크다운 금지
- 영업/유도 표현 금지
- 진정성 있고 따뜻한 톤

### 11. 업종 확장 ✅ (NEW)

#### 지원 업종 목록 ✅
| 업종 | 아이콘 | 규제여부 |
|------|--------|----------|
| 반영구 | ✨ | O (1인칭 금지) |
| 두피/탈모 | 🌱 | X |
| 피부 관리 | 💎 | X |
| 네일 아트 | 💅 | X |
| 헤어 | 💇 | X |
| 메이크업 | 💄 | X |
| 왁싱 | 🪶 | X |
| **속눈썹** | 👁️ | X |

### 12. 관리자 기능 ✅ (NEW)

#### 관리자 무제한 사용 ✅
- 관리자 이메일 화이트리스트
- 무료 플랜이어도 무제한 생성 가능
- 현재 관리자: wldms706@naver.com

---

## 진행 예정 (Stage 2)

### 1. 소셜 로그인 🔜
- [ ] 카카오 로그인
- [ ] 네이버 로그인
- [ ] Supabase OAuth Provider 설정

### 2. 결제 시스템 🔜
- [ ] 토스페이먼츠 or Stripe 연동
- [ ] 구독 플랜 (월 9,900원)
- [ ] 결제 성공 시 plan: 'paid' 업데이트
- [ ] 구독 취소/환불 처리

### 3. 랜딩 페이지 🔜
- [ ] 서비스 소개
- [ ] 가격 정책 안내
- [ ] 데모 영상/스크린샷
- [ ] CTA (회원가입 유도)

### 4. 자동 보정 시스템 🔜

#### 글 품질 자동 체크
- [ ] 키워드 밀도 체크 (3~5% 권장)
- [ ] 금지 표현 필터링 ("최고", "1등", "예약하세요" 등)
- [ ] 반복 단어 감지 (10회 이상 반복 경고)
- [ ] 글자수 체크 (1,500자 이상)

#### 자동 수정 제안
- [ ] 문제 발견 시 자동 수정 옵션 제공
- [ ] 수정 전/후 비교 미리보기
- [ ] "규칙은 시스템이 책임집니다" - 사용자는 클릭만

### 6. 추가 기능 (선택)
- [ ] 글 수정/재생성 기능
- [ ] 여러 버전 비교
- [ ] 글 내보내기 (워드, 한글)
- [ ] 글 예약 발행 (블로그 API 연동)
- [ ] 경쟁사 블로그 분석

---

## 현재 워크플로우

### SEO 글 (9단계)
```
1. 글 유형 선택 (SEO / 브랜딩)  ← NEW
2. 업종 선택
3. AI 키워드 추천 (지역+지수 기반) 또는 직접 입력
4. 주제 선택
5. 목적 선택
6. 독자 상태 선택
7. 규칙 확인
8. AI 제목 추천 (3개) 또는 직접 입력
9. 글 생성
```

### 브랜딩 글 (7단계) ← NEW
```
1. 글 유형 선택 (SEO / 브랜딩)
2. 업종 선택
3. 브랜딩 종류 선택 (자기소개/철학/샵스토리)
4. 키워드 입력
5. 구체적 질문 답변 (4개 항목)
6. AI 제목 추천 (3개) 또는 직접 입력
7. 글 생성
```

### 설정에서 미리 입력
- 샵 위치 (시/구/동)
- 블로그 URL
- 블로그 지수 (블덱스 기준)

---

## 플랜 및 가격

| 플랜 | 가격 | 기능 |
|------|------|------|
| 무료 | 0원 | 하루 3회 생성 |
| 프로 | 월 9,900원 | 무제한 생성 |

---

## 환경 변수

```env
# Gemini API
GEMINI_API_KEY=

# Supabase
NEXT_PUBLIC_SUPABASE_URL=
NEXT_PUBLIC_SUPABASE_ANON_KEY=

# (예정) 결제
TOSS_CLIENT_KEY=
TOSS_SECRET_KEY=
```

---

## DB 스키마

### profiles
```sql
create table profiles (
  id uuid references auth.users primary key,
  email text,
  plan text default 'free',  -- 'free' | 'paid'
  daily_usage int default 0,
  last_usage_date date,
  -- 지역 정보
  location_city text,        -- 시/도 (예: 서울시)
  location_district text,    -- 구 (예: 강남구)
  location_neighborhood text, -- 동 (예: 신사동)
  -- 블로그 정보 (블덱스 기준)
  blog_url text,             -- 네이버 블로그 URL
  blog_index_level text,     -- 'optimal1'~'optimal3', 'sub0'~'sub7'
  blog_index_checked_at timestamptz,
  created_at timestamptz default now()
);
```

### blog_index_level 값 설명
| 값 | 이름 | 키워드 전략 |
|---|---|---|
| optimal3, optimal2, optimal1 | 최적화 | 구/시 단위 경쟁 키워드 |
| sub7, sub6, sub5 | 준최적화 상위 | 동 단위 키워드 |
| sub4, sub3, sub2, sub1 | 준최적화 하위 | 동 + 세부 키워드 조합 |
| sub0 | 일반 | 초세부 틈새 키워드 |

### histories
```sql
create table histories (
  id uuid primary key default gen_random_uuid(),
  user_id uuid references profiles(id) on delete cascade,
  keyword text not null,
  business_category text,
  topic text,
  purpose text,
  content text not null,
  created_at timestamptz default now()
);
```

### settings
```sql
create table settings (
  user_id uuid references profiles(id) on delete cascade primary key,
  default_business_category text
);
```

---

## 파일 구조

```
src/
├── app/
│   ├── (app)/              # 인증 필요 영역
│   │   ├── layout.tsx      # 메인 레이아웃 (사이드바+탑바)
│   │   ├── page.tsx        # 홈 (글 생성 마법사 - SEO 9단계 / 브랜딩 7단계)
│   │   ├── history/        # 히스토리 페이지
│   │   ├── settings/       # 설정 페이지 (지역+블로그지수)
│   │   └── LogoutButton.tsx
│   ├── (auth)/             # 인증 페이지
│   │   ├── layout.tsx
│   │   ├── login/
│   │   └── signup/
│   └── api/
│       ├── generate/           # 본문 생성 API (SEO + 브랜딩)
│       ├── generate-titles/    # 제목 추천 API (SEO + 브랜딩)
│       └── recommend-keywords/ # 키워드 추천 API
├── components/
│   ├── StepProgress.tsx        # 진행바 (동적 스텝 지원)
│   └── steps/                  # 마법사 컴포넌트
│       ├── StepContentType.tsx # 글 유형 선택 (NEW)
│       ├── StepBusiness.tsx
│       ├── StepKeyword.tsx     # AI 키워드 추천 포함
│       ├── StepTopic.tsx       # SEO 전용
│       ├── StepPurpose.tsx     # SEO 전용
│       ├── StepReader.tsx      # SEO 전용
│       ├── StepRules.tsx       # SEO 전용
│       ├── StepBrandingType.tsx   # 브랜딩 종류 선택 (NEW)
│       ├── StepBrandingInfo.tsx   # 브랜딩 정보 입력 (NEW)
│       ├── StepTitleSelect.tsx # AI 제목 추천
│       └── StepGenerate.tsx
├── lib/
│   ├── supabase/
│   │   ├── client.ts       # 브라우저용
│   │   └── server.ts       # 서버용
│   ├── storage.ts          # DB CRUD (지역/블로그 정보 포함)
│   └── usage.ts            # 사용량 관리 (관리자 화이트리스트 포함)
├── middleware.ts           # 인증 미들웨어
├── types/
│   └── index.ts            # 타입 정의 (ContentType, BrandingType, BrandingInfo 등)
└── data/
    └── constants.ts        # 업종/주제/목적/스텝 등 상수
```

---

## 배포 URL
- Production: https://blog-writer-ebon.vercel.app
- GitHub: https://github.com/wldms706/blog-writer

---

## 변경 이력

| 날짜 | 내용 |
|------|------|
| 2026-01-29 | **속눈썹 업종 추가** - 속눈썹 연장, 펌, 리프팅 업종 지원 |
| 2026-01-29 | **브랜딩 글 구체적 질문** - 브랜딩 종류별 4개 질문으로 정보 수집 |
| 2026-01-29 | **브랜딩 글 작성 기능** - SEO/브랜딩 글 유형 선택, 자기소개/철학/샵스토리 지원 |
| 2026-01-29 | **관리자 무제한 사용** - 관리자 이메일 화이트리스트 (wldms706@naver.com) |
| 2026-01-29 | **키워드 배치 규칙 강화** - 처음/중간/마지막 3회 필수 배치, 프롬프트 강화 |
| 2026-01-29 | **키워드 형광펜 하이라이트** - 생성된 글에서 핵심 키워드 노란색 표시 |
| 2026-01-29 | **AI 제목 추천 시스템 추가** - 글 생성 전 제목 후보 3개 추천 (궁금증/수치화/자극적) |
| 2026-01-29 | **블로그 지수 그룹 변경** - 최적(1~3), 준최 상위(5~7), 준최 하위(1~4), 일반(구 준최0) |
| 2026-01-29 | **스마트 키워드 추천** - 지역+업종+블로그지수 기반 AI 키워드 5개 추천 |
| 2026-01-29 | **블덱스 기반 지수 시스템** - 최적1~3, 준최0~7 체계 적용 |
| 2026-01-29 | **1인칭 표현 금지 강화** - 반영구 업종 "저는/제가/저희" 절대 금지 |
| 2026-01-28 | **설정 페이지 확장** - 샵 위치(시/구/동) + 블로그 URL + 블로그 지수 |
| 2026-01-28 | Stage 1 완료: Supabase 인증 + DB + 사용량 제한 |
| 2026-01-28 | Gemini 2.0 Flash API 연동 |
| 2026-01-28 | 초기 버전 배포 |
